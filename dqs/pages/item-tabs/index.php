    <?php
    include('../../db.php');
    include('../session_handler.php');
    session_start();
    // echo '<pre>';
    //     //  print_r($_POST);
    //      print_r($_SESSION);
    // echo '</pre>';
    if(isset($_SESSION['item_id'])){
        $ids = $_SESSION['item_id'];
    }else{
        header('location: ../../index.php');
    }
?>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./cart.css">
    <link rel="stylesheet" href="../../master.css">
    <link rel="stylesheet" href="./input.css">
    <link rel="stylesheet" href="./items.css">
    <link rel="stylesheet" href="../confirmation.css">
    <script src="./cartscript.js" defer></script>
    <script src="./dev-listener.js" defer></script>
    <script src="../session_data_fetcher.js" defer></script>
    <script src="../confirmation.js" defer></script>
    <script src="../../JSLibraries/jQuery/jquery-3.7.1.js" ></script>
    <title>DQS</title>
</head>
<body id="cart">
    <main>
        <nav>
            <button onclick="window.location.href = '../../index.php'" id="back-to">&lt;-</button>
            <h1>
                <div class="dqs-logo">
                    <?xml version="1.0" encoding="UTF-8"?>
                    <svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 456.84 312.12">
                        <path class="dqs-color" d="m231.07,239.87c-62.3,0-124.6,0-186.9,0-7.42,0-11.7-4.18-11.68-11.79.02-7.02,4.05-12.27,11.8-12.27,45.04-.01,90.07,0,135.11,0,79.41,0,158.83,0,238.24,0,4.66,0,8.75,1.45,10.95,6.31,2.32,5.13,1.72,10.47-1.93,14.38-1.85,1.99-5.15,3.24-7.8,3.25-62.6.18-125.2.14-187.8.14Z"/>
                        <path class="dqs-color" d="m163.56,96.44c-39.79,0-79.57,0-119.36-.01-4.46,0-7.77-2.02-10.09-6.52-2.57-4.96-1.83-9.34,1.05-13.52,3.11-4.51,7.98-4.76,12.34-4.79,41.44-.22,82.87-.17,124.31-.18,33.34-.01,66.68-.08,100.02.08,4.95.02,9.92,1,14.83,1.91,5.4,1,7.66,5.77,7.05,13.18-.44,5.43-5.11,9.8-10.34,9.82-15.61.05-31.23.02-46.84.03-24.32,0-48.64,0-72.97,0Z"/>
                        <path class="dqs-color" d="m346.99,168.56c-22.96,0-45.91-.03-68.87.02-7.6.02-12.94-4.85-13.2-12.3-.23-6.81,4.65-11.98,11.97-12.63,1.19-.11,2.4-.05,3.6-.05,44.71,0,89.42-.07,134.13.12,3.65.02,7.65,1.01,10.84,2.91,4.07,2.43,5.43,8.17,4.18,12.58-1.62,5.72-6.33,9.44-11.99,9.44-23.56,0-47.11,0-70.67,0,0-.03,0-.06,0-.08Z"/>
                        <path class="dqs-color" d="m367.25,96.45c-17.11,0-34.23,0-51.34,0-6.4,0-10.86-3.99-11.37-9.56-.91-9.86,3.96-14.31,10.52-14.51,9.38-.29,18.75-.84,28.13-.91,20.87-.14,41.74-.1,62.6,0,5.04.03,10.1.43,15.12.96,5.53.59,9.18,6.1,8.9,13-.23,5.74-5.02,10.96-10.32,10.98-17.41.05-34.83.02-52.24.02v.02Z"/>
                        <path class="dqs-color" d="m162.77,179.7c7.2,0,14.42-.33,21.6.1,6.5.39,10.51,2.19,12.61,9,1.9,6.15-2.96,14.99-8.5,15.04-15.66.14-31.33.95-46.99.79-7.9-.08-11.32-5.05-11.86-12.83-.46-6.59,3.75-11.71,11.09-12.02,7.34-.31,14.7-.07,22.05-.08Z"/>
                        <path class="dqs-color" d="m298.92,132.53c-7.2,0-14.41-.31-21.58.08-8.47.46-14.41-8.25-11.2-17.87,1.35-4.05,4.61-5.87,8.23-6.18,6.8-.58,13.63-1.04,20.44-1,9.68.05,19.35.54,29.02.95,5.07.22,9.38,5.7,9.51,11.83.13,5.95-5.08,12.08-10.58,12.17-7.94.12-15.89.03-23.84.02Z"/>
                        <path class="dqs-color" d="m164.29,168.66c-8.74,0-15.78.02-22.82,0-5.94-.02-11.22-5.08-11.75-10.68-.89-9.42,4.98-13.98,10.8-14.18,14.67-.49,29.36-.43,44.04-.07,5.32.13,10.35,1.9,12.32,8.82,1.77,6.24-1.57,12.07-6.98,14.28-9.07,3.71-18.26.43-25.6,1.83Z"/>
                        <path class="dqs-color" d="m162.96,132.53c-7.35,0-14.71.04-22.06-.01-4.39-.03-9.79-4.2-10.99-8.35-1.42-4.9.12-11.3,4.41-13.94,2.9-1.79,6.65-2.52,10.04-2.61,11.55-.31,23.11-.23,34.67-.06,3.66.05,7.49.2,10.94,1.4,6.08,2.13,7.52,6.48,7.28,12.76-.23,5.9-5.43,10.63-11.31,10.77-7.65.18-15.31.04-22.96.04Z"/>
                        <path class="dqs-color" d="m295.57,179.21c7.7.49,15.43.65,23.08,1.61,4.81.61,7.49,5.13,7.54,10.84.05,5.88-2.85,10.9-7.31,12-2.69.66-5.49.96-8.25.99-10.63.13-21.28.49-31.89-.04-6.74-.34-11.55-1.17-12.86-9.33-1.72-10.66,3.64-15.06,10.8-15.49,6.27-.38,12.58-.08,18.87-.08,0-.16.01-.33.02-.49Z"/>
                        <path class="dqs-color" d="m30.46,179.21c7.7.49,15.43.65,23.08,1.6,4.81.6,7.69,5.22,7.74,10.64.06,6.16-2.87,11.11-7.55,12.21-2.69.63-5.49.95-8.25.98-10.48.12-20.98.44-31.44-.03-7.19-.32-11.64-1.58-13.09-9.11-1.72-8.95,2.75-15.64,11.07-15.79,6.14-.12,12.28-.02,18.42-.02l.02-.49Z"/>
                        <path class="dqs-color" d="m295.48,312.07c-6.29,0-12.58.03-18.87,0-6.21-.04-11.49-5.41-11.69-11.83-.21-6.83,3.79-11.8,10.51-12.14,11.14-.57,22.3-.8,33.45-.97,3.08-.05,6.2.38,9.23,1,5.52,1.14,8.49,6.19,8.08,13.21-.32,5.53-5.08,10.56-10.49,10.7-6.74.17-13.48.04-20.22.03Z"/>
                        <path class="dqs-color" d="m30.83,168.6c-6,0-12.05.53-17.98-.2-3.47-.43-7.89-1.83-9.88-4.58-5.84-8.05-1.85-19.72,8.87-20.09,12.14-.41,24.3-.29,36.44,0,2.92.07,6.13,1.1,8.63,2.77,4,2.68,5.45,8.07,4.26,12.57-1.45,5.49-6.12,9.5-11.44,9.58-6.3.09-12.6.02-18.89.02,0-.02,0-.04,0-.07Z"/>
                        <path class="dqs-color" d="m30.63,132.53c-6.15,0-12.3.05-18.45-.01-6.66-.07-11.5-4.9-12.15-12.01-.49-5.37,4.32-11.68,10.34-11.9,12.88-.46,25.79-.24,38.69-.05,2.68.04,5.74.49,7.94,1.99,4.13,2.81,5.53,8.74,4.07,13.62-1.25,4.18-6.64,8.21-11.56,8.32-6.3.14-12.6.03-18.9.03Z"/>
                        <path class="dqs-color" d="m295.45,275.96c-6.6,0-13.21.05-19.81-.02-5.47-.05-10.52-5.75-10.68-11.91-.16-5.99,4.57-11.97,10.18-12.05,13.8-.21,27.61-.19,41.42-.02,5.74.07,9.68,5.36,9.63,12.17-.05,6.66-4.16,11.66-10.03,11.8-6.9.16-13.81.04-20.71.03Z"/>
                        <path class="dqs-color" d="m159.35,24.24c-6.31,0-12.61,0-18.92,0-6.38-.01-10.4-4.16-10.68-10.84-.35-8.22,3.54-12.85,10.11-13.08,13.35-.46,26.73-.38,40.09-.06,7.27.18,10.47,5.03,10.18,13.9-.19,5.89-4.68,10.04-10.96,10.07-6.61.03-13.21,0-19.82,0Z"/>
                        <path class="dqs-color" d="m160.01,60.34c-6.45,0-12.9.04-19.34-.01-6.84-.06-10.92-4.71-10.9-12.29.02-7.15,4.2-11.74,10.85-11.76,12.9-.04,25.79-.05,38.69,0,6.9.03,10.83,4.55,10.83,12.26,0,7.23-4.09,11.73-10.78,11.78-6.45.05-12.9.01-19.34,0Z"/>
                        <path class="dqs-color" d="m430.92,205.19c-7.09-.48-14.22-.56-21.25-1.56-5.87-.84-9.09-6.08-8.7-12.46.38-6.14,4.76-11.29,10.3-11.37,12.88-.2,25.76-.22,38.64-.03,6.5.1,6.92.87,6.92,8.02,0,2.5,0,5,0,7.5,0,8.95-.52,9.51-8.82,9.47-2.84-.01-5.69-.01-8.54-.01-2.85,0-5.69,0-8.54,0,0,.15-.01.31-.02.46Z"/>
                    </svg>
                </div>
            </h1>
            <svg width="800px" height="800px" viewbox="0 0 82.43 82.43" id="support" xlmns="http://www.w3.org/2000/svg" xlm:space="preserve">
                <g>
                    <path d="M 76.712 62.718 c -0.672 -1.567 -1.792 -1.792 -3.136 -2.239 c -6.496 -2.463 -11.872 -3.584 -18.145 -5.823 c -0.449 -0.224 -2.24 -1.345 -2.24 -4.479 c 0 -1.344 -0.225 -2.016 -1.793 -2.016 c -0.446 0 -0.225 0 -0.446 -0.896 c -0.448 -2.912 -0.448 -4.479 -0.448 -4.929 s 0.448 -0.896 0.672 -1.12 c 2.24 -2.912 2.688 -6.72 2.688 -8.512 c 0 0 0.446 0.224 0.896 -0.896 c 0.448 -1.344 0.674 -1.791 1.12 -3.358 c 0.448 -1.12 0.673 -3.584 -0.896 -3.584 c -0.896 0.447 -0.672 0 -0.672 -1.12 c 0 -3.36 0 -4.929 0 -8.288 c -0.226 -2.912 -2.018 -4.704 -3.359 -5.601 c -2.016 -1.344 -2.688 -1.792 -3.584 -2.464 s -0.672 -1.567 0 -2.464 c 0.447 -0.448 0.896 -0.672 1.344 -0.896 c 5.152 2.912 8.96 8.288 8.96 14.783 v 4.48 c -0.896 0.672 -1.344 2.464 -1.344 4.256 c 0 1.344 0.226 2.688 0.672 3.36 l -1.12 6.048 c -0.445 0.225 -0.896 0.896 -0.896 1.568 c 0 0.896 0.673 1.791 1.794 1.791 c 0.896 0 1.791 -0.673 1.791 -1.791 c 0 -0.448 -0.224 -0.896 -0.447 -1.12 l 1.119 -5.152 c 1.345 -0.224 2.465 -2.239 2.465 -4.704 c 0 -1.792 -0.672 -3.584 -1.567 -4.256 v -4.48 C 60.139 8.511 51.626 0 41.323 0 C 31.02 0 22.506 8.511 22.506 18.815 v 4.48 c -0.896 0.672 -1.567 2.464 -1.567 4.256 c 0 2.688 1.12 4.704 2.688 4.704 c 1.345 0 2.464 -2.017 2.464 -4.704 c 0 -1.792 -0.447 -3.584 -1.344 -4.256 v -4.48 c 0 -9.407 7.615 -16.575 16.575 -16.575 c 2.688 0 5.152 0.672 7.393 1.792 c -0.445 0 -5.15 0.672 -6.943 1.12 c -3.584 0.896 -7.168 2.016 -9.855 4.479 c -2.017 1.568 -3.809 3.584 -4.032 6.272 c 0 1.344 0 5.823 0 8.287 c 0 0.673 0 1.12 -0.672 0.896 c -1.792 0 -0.672 3.136 -0.672 3.36 c 0.447 1.791 0.672 2.239 1.119 3.584 c 0.225 1.118 0.673 0.896 0.673 0.896 c 0.447 2.24 1.344 6.272 3.136 8.514 c 0.225 0.225 0.448 0.672 0.448 1.119 c -0.225 1.567 -0.225 3.359 -0.448 4.928 c 0 0.226 -0.225 0.896 -0.672 0.896 c -1.345 0 -1.567 0.896 -1.567 2.016 c -0.225 2.24 -1.345 4.033 -2.24 4.48 c -3.136 1.344 -14.111 4.704 -17.695 5.824 c -2.465 0.445 -3.137 1.344 -3.584 2.24 l -3.137 8.062 c 13.889 0 21.057 8.736 35.393 10.976 c 0 0 2.017 0.449 3.359 0.449 c 1.345 0 3.361 -0.449 3.361 -0.449 c 14.781 -2.463 25.088 -10.976 35.168 -10.976 L 76.712 62.718 Z M 31.239 59.134 l 2.688 2.688 l 1.568 0.225 l 2.017 -2.016 l -0.448 -1.568 l -2.688 -2.688 c 1.567 -0.447 3.137 0 4.256 1.119 c 1.345 1.345 1.567 3.138 1.12 4.705 l 0 0 l -1.792 1.791 h -0.671 l -1.12 1.119 c -1.345 0.225 -2.688 -0.224 -3.584 -1.344 C 31.239 62.271 30.792 60.479 31.239 59.134 Z M 36.168 76.383 l -1.792 -0.224 l -2.912 -2.912 l -0.225 -1.792 l 6.496 -6.496 l 1.792 0.225 l -0.447 -0.672 l 1.119 -1.121 l 1.568 1.568 l 5.601 -5.602 l 0.446 -1.344 l 2.688 -2.017 l 1.347 1.565 l -2.019 2.688 l -1.345 0.448 l -5.6 5.6 l 1.344 1.344 l -1.119 1.121 l -0.672 -0.449 l 0.224 1.795 L 36.168 76.383 Z M 51.85 73.471 l -2.688 -2.688 l -1.345 -0.226 l -2.018 2.018 l 0.227 1.344 l 2.688 2.688 c -1.566 0.447 -3.136 0 -4.256 -1.119 s -1.344 -2.465 -1.12 -3.81 l 1.12 -1.12 v -0.672 l 1.792 -1.792 l 0 0 c 1.567 -0.448 3.36 -0.224 4.704 1.12 C 51.85 70.111 52.296 71.902 51.85 73.471 Z");></path>
                </g>
            </svg>
        </nav>
        <section>
            <h1>ITEMS</h1>
            <hr>
            <div id="container-cart">
                <?php
                    $folder_path = '../../assets/product_images/';
                    foreach($ids as $id){
                       if($item = mysqli_fetch_assoc(mysqli_query($conn, ("SELECT * FROM `products` where `product_id` = '$id'; ")))){
                        echo '<div class="item" data-id="'.$id.'">';
                            echo '<img src="'.$folder_path. $item['product_photo'].'">';
                            echo '<div class="info-sect">';
                                echo '<p class="item-name">'.$item['product_name'].'</p>'; 
                                echo '<p class="item-price">'.$item['product_price'].'</p>'; 
                                if($item['product_weight'] > 0){
                                    echo '<p class="item-">'.$item['product_weight'].'g</p>'; 
                                }else{
                                    echo '<p class="item-">'.$item['product_volume'].'mL</p>'; 
                                }
                                echo '<p class="item-category">'.$item['product_category'].'</p>'; 
                            echo '</div>';
                            echo '<button class="remove">X</button>';
                        echo '</div>';
                       }
                    }
                ?>
            </div>
        </section>
        <aside>
            <h1>INFORMATION:</h1>
            <hr>
            <div id="info-con">
                <img src="" alt="" id="item-img">
                <h4>Name: <br><span id="item-name"></span></h4>
                <h4>Brand: <br><span id="item-brand"></span></h4>
                <h4>Weight: <br><span id="item-weight"></span></h4>
                <h4>Price: <br>₱<span id="item-price"></span></h4>
            </div>
            <div id="checkout">
                <div id="total-sec">
                    <h2>Total : </h2>
                    <span id="total"><?php echo '₱ '.$_SESSION['total_cart']; ?></span>
                </div>
                <hr>
                <a href="../checkout/index.php" id="lessgo"><h3>CHECK OUT</h3></a>
            </div>
        </aside>
    </main>
    <button id="dev-tool">
        <svg fill="#000000" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 45.973 45.973"
	 xml:space="preserve">
        <g>
            <g>
                <path d="M43.454,18.443h-2.437c-0.453-1.766-1.16-3.42-2.082-4.933l1.752-1.756c0.473-0.473,0.733-1.104,0.733-1.774
                    c0-0.669-0.262-1.301-0.733-1.773l-2.92-2.917c-0.947-0.948-2.602-0.947-3.545-0.001l-1.826,1.815
                    C30.9,6.232,29.296,5.56,27.529,5.128V2.52c0-1.383-1.105-2.52-2.488-2.52h-4.128c-1.383,0-2.471,1.137-2.471,2.52v2.607
                    c-1.766,0.431-3.38,1.104-4.878,1.977l-1.825-1.815c-0.946-0.948-2.602-0.947-3.551-0.001L5.27,8.205
                    C4.802,8.672,4.535,9.318,4.535,9.978c0,0.669,0.259,1.299,0.733,1.772l1.752,1.76c-0.921,1.513-1.629,3.167-2.081,4.933H2.501
                    C1.117,18.443,0,19.555,0,20.935v4.125c0,1.384,1.117,2.471,2.501,2.471h2.438c0.452,1.766,1.159,3.43,2.079,4.943l-1.752,1.763
                    c-0.474,0.473-0.734,1.106-0.734,1.776s0.261,1.303,0.734,1.776l2.92,2.919c0.474,0.473,1.103,0.733,1.772,0.733
                    s1.299-0.261,1.773-0.733l1.833-1.816c1.498,0.873,3.112,1.545,4.878,1.978v2.604c0,1.383,1.088,2.498,2.471,2.498h4.128
                    c1.383,0,2.488-1.115,2.488-2.498v-2.605c1.767-0.432,3.371-1.104,4.869-1.977l1.817,1.812c0.474,0.475,1.104,0.735,1.775,0.735
                    c0.67,0,1.301-0.261,1.774-0.733l2.92-2.917c0.473-0.472,0.732-1.103,0.734-1.772c0-0.67-0.262-1.299-0.734-1.773l-1.75-1.77
                    c0.92-1.514,1.627-3.179,2.08-4.943h2.438c1.383,0,2.52-1.087,2.52-2.471v-4.125C45.973,19.555,44.837,18.443,43.454,18.443z
                    M22.976,30.85c-4.378,0-7.928-3.517-7.928-7.852c0-4.338,3.55-7.85,7.928-7.85c4.379,0,7.931,3.512,7.931,7.85
                    C30.906,27.334,27.355,30.85,22.976,30.85z"/>
            </g>
        </g>
        </svg>
    </button>
    <div id="input" style="display: none;">
        <div id="sample-items-section">
            <?php
                $item_finder = mysqli_query($conn, ("SELECT * FROM `products`;"));
                $categories = [];
                while($results = mysqli_fetch_assoc($item_finder)){
                    $categories[$results['product_category']][] = $results;
                }   
                foreach($categories as $category => $items){
                    echo '<p>'.$category.'</p>';
                    foreach($items as $item){
                        if($item['product_stock'] > 0){
                            if($item['product_weight']){
                                echo '<button class="sample-item" title="'.$item['product_name'].' '. $item['product_weight'].'g">';
                                    echo '<h1 data-console-id="'.$item['product_id'].'">'.$item['product_name'] . ' ' .$item['product_weight'].'g</h1>';
                                echo '</button>';
                            }else{
                                echo '<button class="sample-item" title="'.$item['product_name'].' '. $item['product_volume'].'g">';
                                    echo '<h1 data-console-id="'.$item['product_id'].'">'.$item['product_name'] . ' ' .$item['product_volume'].'g</h1>';
                                echo '</button>';
                            }
                        }
                    }
                }
            ?>
        </div>
    </div>
    <div id="confirmation-box" class="modal">
        <div class="modal-contents">
            <p class="confirmation-text"></p>
            <div>
                <button id="confirm_yes">Yes</button>
                <button id="confirm_no">No</button>
            </div>
        </div>
    </div>
    <div id="error-box" class="modal">
        <div class="modal-contents">
            <h3 style="text-align: center;">Cart Empty! Please add items to your cart before procedding to your checkout.</h3>
        </div>
    </div>
</body>
</html>